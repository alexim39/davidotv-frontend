<div class="video-player-container">
  <!-- Video Container -->
  <div class="video-container" *ngIf="safeUrl; else loadingTpl">
    <div class="video-wrapper">
      <iframe
        #videoFrame
        [src]="safeUrl"
        width="100%"
        height="100%"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
        title="{{ videoTitle }}"
        (load)="playerReady = true"
        aria-label="Davido video player"
        tabindex="0"
      ></iframe>
    </div>

    <!-- Video Overlay -->
    <div class="video-overlay" *ngIf="showOverlay" (click)="playVideo()">
      <div class="overlay-content">
        <button class="play-button" (click)="playVideo(); $event.stopPropagation()">
          <mat-icon>play_circle_filled</mat-icon>
        </button>
        <h2>{{ videoTitle }}</h2>
      </div>
    </div>

    <!-- Video Controls -->
    <div class="video-controls" *ngIf="controlsVisible || !isPlaying" 
         [class.visible]="controlsVisible || !isPlaying">
      <div class="progress-bar">
        <mat-progress-bar mode="determinate" [value]="progress"></mat-progress-bar>
      </div>
      
      <div class="controls-container">
        <div class="left-controls">
          <button mat-icon-button (click)="togglePlayPause()" aria-label="Play/Pause">
            <mat-icon>{{ isPlaying ? 'pause' : 'play_arrow' }}</mat-icon>
          </button>
          
          <button mat-icon-button (click)="playPreviousVideo()" aria-label="Previous">
            <mat-icon>skip_previous</mat-icon>
          </button>
          
          <button mat-icon-button (click)="playNextVideo()" aria-label="Next">
            <mat-icon>skip_next</mat-icon>
          </button>
          
          <span class="time-display">{{ currentTime }} / {{ duration }}</span>
        </div>
        
        <div class="right-controls">
          <button mat-icon-button (click)="toggleRepeatMode()" [class.active]="repeatMode !== 'none'">
            <mat-icon>
              {{ repeatMode === 'one' ? 'repeat_one' : 'repeat' }}
            </mat-icon>
          </button>
          
          <button mat-icon-button (click)="toggleMute()">
            <mat-icon>{{ isMuted ? 'volume_off' : 'volume_up' }}</mat-icon>
          </button>
          
          <button mat-icon-button (click)="toggleFullscreen()">
            <mat-icon>fullscreen</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </div>

  <ng-template #loadingTpl>
    <div class="loading-container">
      <mat-spinner diameter="50"></mat-spinner>
      <p class="loading-text">Loading Davido's content...</p>
    </div>
  </ng-template>

  <!-- Video Info Section -->
  <div class="video-info" *ngIf="!isLoading">
    <h2>{{ videoTitle }}</h2>
    <div class="video-meta">
      <span class="views">{{ views | number }} views</span>
      <span class="upload-date">{{ uploadDate | date }}</span>
    </div>
    <div class="video-description">
      <p>{{ videoDescription }}</p>
    </div>
  </div>
</div>